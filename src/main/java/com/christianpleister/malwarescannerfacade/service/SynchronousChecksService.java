package com.christianpleister.malwarescannerfacade.service;

import com.christianpleister.malwarescannerfacade.synchronousChecks.SynchronousCheck;
import org.springframework.stereotype.Service;

import java.io.InputStream;
import java.util.List;

@Service
public class SynchronousChecksService {

    private final List<SynchronousCheck> syncChecks;

    public SynchronousChecksService(List<SynchronousCheck> syncChecks) {
        this.syncChecks = syncChecks;
    }

    public Boolean check(InputStream file){
            return syncChecks.parallelStream().allMatch(check -> check.execute(file));
    }
}
